<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Beth  Jelfs | 3D Orientation Estimation</title>
<meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design.
">

<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&display=swap">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />

<!-- Styles -->
<link rel="shortcut icon" href="/assets/img/favicon.ico">
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="canonical" href="/research/orientation/">

  </head>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
        <a class="navbar-brand title font-weight-lighter" href="/">
         <span class="font-weight-bold">Beth</span>   Jelfs
        </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              About
              
            </a>
          </li>
          
          <!-- Blog -->
          <li class="nav-item ">
            <a class="nav-link" href="/news/">
              News
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
            
          
            
          
            
              <li class="nav-item ">
                <a class="nav-link" href="/cv/">
                  CV
                  
                </a>
              </li>
            
          
            
          
            
          
            
          
            
              <li class="nav-item ">
                <a class="nav-link" href="/publications/">
                  Publications
                  
                </a>
              </li>
            
          
            
              <li class="nav-item active">
                <a class="nav-link" href="/research/">
                  Research
                  
                </a>
              </li>
            
          
            
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      <div class="post">

  <header class="post-header">
    <h1 class="post-title">3D Orientation Estimation</h1>
    <p class="post-description">Image gradients and directional statistics for determining fibre alignment</p>
  </header>

  <article>
    <p>We have developed an efficient, parallelisable computational method to determine 3D orientations at a local level. Quantifying the orientation and alignment of cells and fibres in 3D is of growing interest. Tissue function is affected by this alignment and with increases in the development and use of 3D scaffolds in bioengineering there is a need to be able determine their performance.</p>

<p>The algorithm performs the following steps <a class="citation" href="#Jelfs2020">[1]</a></p>

<ul>
  <li>Computes the image intensity gradients</li>
  <li>Classifies the vectors into spherical and non-spherical using circularity testing</li>
  <li>Computes the local orientation vectors for the identified non-spherical vectors</li>
  <li>Assesses the distribution of the estimated local orientations over the whole volume</li>
</ul>

<hr />

<h3 id="image-intensity-gradients">Image Intensity Gradients</h3>
<div class="row align-items-center justify-content-center">
  <div class="col-sm-4 mt-3 mt-md-0"><img class="img-fluid rounded z-depth-1 p-2" src="/assets/img/GradientVector.png" alt="" title="Gradient Vector Diagram" /></div>
  <div class="col-sm-8 mt-3 mt-md-0">Differentials of the volumetric images in each dimension \(i\) are obtained via convolution $$G_i(x,y,z) = I(x,y,z)\ast h_i(x,y,z)$$ where \(h_i\) is a Gaussian derivative filter to form a 3D vector field \(\vec{G}(x,y,z)\).
    <ul>
      <li>The magnitude of \(\vec{G}\) is large at object boundaries</li>
      <li>The direction is normal to its local orientation</li>
    </ul>
    Therefore estimating local orientation requires estimating normal vectors to \(\vec{G}\)</div>
</div>
<div class="caption text-left">
    Gradient vector diagram.
</div>

<div class="row align-items-center justify-content-center">
  <div class="col-sm-8 mt-3 mt-md-0">The girdle distribution models data points in spherical polar coordinates concentrated on a great circle. The distribution is characterised by:
    <ul>
      <li>Concentration of points around the circle</li>
      <li>Orientation of the polar axis</li>
    </ul>
    Estimating the local orientation then becomes that of determining the polar axis.</div>
  <div class="col-sm-4 mt-3 mt-md-0"><img class="img-fluid rounded z-depth-1 p-2" src="/assets/img/GirdleDistribution.png" alt="" title="Girdle Distribution" /></div>
</div>
<div class="caption text-right">
    Girdle distribution.
</div>

<p>Our solution adapts a maximum-likelihood estimator from spherical statistics to estimate the polar axis using a local region of \(\vec{G}(x,y,z)\) rather than spherical data by:</p>

<ol>
  <li>Calculating an estimator for a uniform grid of axis angles</li>
  <li>Choosing a pair of axis angles that minimise the estimator</li>
</ol>

<p>This method is efficient to computer, can perform the per voxel polar axis estimation in parallel and allows for a customisable search space based on the size of the grid.</p>

<hr />

<h3 id="complex-statistics">Complex Statistics</h3>
<div class="row align-items-center justify-content-center">
  <div class="col-sm-6 mt-3 mt-md-0"><p>Having obtained a local orientation we need to determine whether the estimate is meaningful, if the local image vectors are spherical then a local orientation angle is meaningless.</p>
    <p>Many tests for sphericity are tailored to a particular statistical distribution or are computationally intensive. Our solution is to project the data into the 3 coordinate planes and then test for circularity.  
      <ul><li>Data which is non-circular in one or more plane is non-spherical</li></ul>
      But we also need to consider not only the distribution of the angles but also the magnitude
        <ul>
        <li>Considering only the angles does not give all of the information
          <ul><li>Non-spherical data can be uniformly distributed across all angles</li></ul>
        </li>
        <li>Using both angle and magnitude shows shows differences in the distributions</li>
        </ul>
        Our approach uses statistics of complex numbers to determine the circularity which takes into account both angle and magnitude and is efficient to compute. </p></div>
  <div class="col-sm-6 mt-3 mt-md-0">
    <div class="row align-items-center justify-content-center">
      <div class="col-sm-6 mt-3 mt-md-0"><img class="img-fluid rounded z-depth-1 p-2" src="/assets/img/Spherical.png" alt="" title="Spherical Data" /></div>
      <div class="col-sm-6 mt-3 mt-md-0"><img class="img-fluid rounded z-depth-1 p-2" src="/assets/img/NonSpherical.png" alt="" title="Non-Spherical Data" /></div>
    </div>
    <div class="caption text-right">
        Left: Spherical data point cloud. Right: Non-spherical data point cloud.
    </div>
    <div class="row align-items-center justify-content-center">
      <div class="col-sm-4 mt-3 mt-md-0"><img class="img-fluid rounded z-depth-1 p-2" src="/assets/img/xy_angle.png" alt="" title="xy Plane Angles" /></div>
      <div class="col-sm-4 mt-3 mt-md-0"><img class="img-fluid rounded z-depth-1 p-2" src="/assets/img/xz_angle.png" alt="" title="xz Plane Angles" /></div>
      <div class="col-sm-4 mt-3 mt-md-0"><img class="img-fluid rounded z-depth-1 p-2" src="/assets/img/yz_angle.png" alt="" title="yz Plane Angles" /></div>
    </div>
    <div class="caption text-right">
        Non-spherical data projected onto the unit circle. Left: \((x,y)\)-plane. Middle: \((x,z)\)-plane Right: \((y,z)\)-plane.
    </div>
    <div class="row align-items-center justify-content-center">
      <div class="col-sm-4 mt-3 mt-md-0"><img class="img-fluid rounded z-depth-1 p-2" src="/assets/img/xy_Dis.png" alt="" title="xy Distribution" /></div>
      <div class="col-sm-4 mt-3 mt-md-0"><img class="img-fluid rounded z-depth-1 p-2" src="/assets/img/xz_Dis.png" alt="" title="xz Distribution" /></div>
      <div class="col-sm-4 mt-3 mt-md-0"><img class="img-fluid rounded z-depth-1 p-2" src="/assets/img/yz_Dis.png" alt="" title="yz Distribution" /></div>
    </div>
    <div class="caption text-right">
        Non-spherical data point cloud. Left: \((x,y)\)-plane. Middle: \((x,z)\)-plane Right: \((y,z)\)-plane.
    </div>
  </div>
</div>

<hr />

<h3 id="simulated-fibres">Simulated Fibres</h3>
<div class="row align-items-center">
  <div class="col-sm-5 mt-3 mt-md-0"><img class="img-fluid rounded z-depth-1 p-2" src="/assets/img/range_orig.gif" alt="" title="Original Range of Angles" /></div>
  <div class="col-sm-2 mt-3 mt-md-0"><img class="img-fluid rounded z-depth-1 p-2" src="/assets/img/ColourWheel.png" alt="" title="Colour Wheel" /></div>
  <div class="col-sm-5 mt-3 mt-md-0"><img class="img-fluid rounded z-depth-1 p-2" src="/assets/img/range_results30.gif" alt="" title="Results Range of Angles" /></div>
</div>
<div class="caption text-right">
    Fibres with a range of elevation angles between 70&deg; and 100&deg; and azimuth angles between 90&deg; and 120&deg;. Left: The original fibres. Middle: Colour key for the different angles. Right: Estimated fibres from noisy data with PSNR = 30dB.
</div>

<hr />

<h3 id="fibrous-scaffold-data">Fibrous Scaffold Data</h3>
<div class="row align-items-center">
  <div class="col-sm-5 mt-3 mt-md-0"><img class="img-fluid rounded z-depth-1 p-2" src="/assets/img/scaffold1.gif" alt="" title="Random Scaffold Data" /></div>
  <div class="col-sm-2 mt-3 mt-md-0"><img class="img-fluid rounded z-depth-1 p-2" src="/assets/img/ColourWheel.png" alt="" title="Colour Wheel" /></div>
  <div class="col-sm-5 mt-3 mt-md-0"><img class="img-fluid rounded z-depth-1 p-2" src="/assets/img/scaffold3.gif" alt="" title="Aligned Scaffold Data" /></div>
</div>
<div class="caption text-right">
    Estimated fibres from real fibrous scaffold data (<a href="https://figshare.com/articles/Quanfima_Datasets/7096208" target="_blank" rel="noopener">datasets available here</a>). Left: Random structures. Middle: Colour key for the different angles. Right: Aligned structures.
</div>

<hr />

<h3 id="assessing-distribution-of-local-orientations">Assessing Distribution of Local Orientations</h3>
<p>To assess the distribution of the local orientation angles across the whole volume the local orientation angles are converted to a set of unit vectors. The assessment of their distribution comprises of four measures:</p>

<ul>
  <li>The three non-circularity measures in each of the planes
    <ul>
      <li>These quantify the sphericity of the overall distribution</li>
    </ul>
  </li>
  <li>The spherical mean resultant length  \(\bar{R} = \lvert\frac{1}{N}\sum_n\vec{v}_n\rvert\)
    <ul>
      <li>This quantifies the concentration of the vectors \(\bar{R}\approx 0\) indicates the vectors are widely dispersed whereas \(\bar{R}\approx 1\) indicates the vectors are heavily concentrated.</li>
    </ul>
  </li>
</ul>

<div class="row justify-content-center">
  <div class="col-sm-10 mt-3 mt-md0 table-responsive"><table table-sm="" table-borderless="" class="project-table">
    <tr><th style="text-align:left;">Datasets</th><th>Elevation Angles</th><th>Azimuth Angles</th><th>\(\ell_{XY}\)</th><th>\(\ell_{YZ}\)</th><th>\(\ell_{XZ}\)</th><th>\(\bar{R}\)</th></tr>
    <tr><td style="text-align:left;">Single</td><td>30&deg;--35&deg;</td><td>70&deg;--75&deg;</td><td>0.83</td><td>0.94</td><td>0.94</td><td>0.96</td></tr>
    <tr><td style="text-align:left;">Double</td><td>30&deg;--35&deg; &amp; 110&deg;--115&deg;</td><td>70&deg;--75&deg; &amp; 150&deg;--155&deg;</td><td>0.80</td><td>0.80</td><td>0.50</td><td>0.35</td></tr>
    <tr><td style="text-align:left;">Range</td><td>70&deg;--100&deg;</td><td>90&deg;--120&deg;</td><td>0.64</td><td>0.80</td><td>0.51</td><td>0.89</td></tr>
    <tr><td style="text-align:left;">Random</td><td>0&deg;--180&deg;</td><td>0&deg;--180&deg;</td><td>0.64</td><td>0.80</td><td>0.51</td><td>0.03</td></tr>
    <tr class="darker"><td style="text-align:left;">Random Scaffold Data</td><td>--</td><td>--</td><td>0.31</td><td>0.34</td><td>0.72</td><td>0.36</td></tr>
    <tr class="darker"><td style="text-align:left;">Aligned Scaffold Data</td><td>--</td><td>--</td><td>0.73</td><td>0.57</td><td>0.07</td><td>0.89</td></tr>
  </table></div>
</div>
<div class="caption text-left">
    Assessment of the distributions of the local orientations. \(\ell\) = degree of non-circularity \(\bar{R}\) = spherical mean resultant length. All simulations had a PSNR of 30dB.
</div>

<hr />

<h3 id="code">Code</h3>
<p>Orientation estimation code can be found here: <a href="https://github.com/beteje/Orientation" target="_blank" rel="noopener">Orientation</a></p>

<hr />

<h3 id="references">References</h3>
<div class="references">
  <ol class="bibliography"><li><div class="row">

  <div id="Jelfs2020" class="col-sm-12">
    
      <div class="title">Application of Image Processing and Circular Statistics to 3D Cellular Alignment</div>
      <div class="author">
        
          
            
              
                <em>B. Jelfs</em>,
              
            
          
        
          
            
              
                and C. Gilliam
              
            
          
        
      </div>

      <div class="periodical">
        
          In <em>Proc. Asia-Pacific Signal and Information Processing Association Annual Summit and Conference,</em>
        
        
          2020,
        
        
        
        
          pp. 992â€“1000.
        
      </div>
    

    <div class="links">
      
        <a class="abstract btn btn-sm z-depth-0 mr-0" role="button">abstract</a>
      
      
      
      
        <a href="https://ieeexplore.ieee.org/document/9306340" class="btn btn-sm z-depth-0 mr-0" role="button" target="_blank" rel="noopener">html</a>
      
      
        <a href="/assets/pdf/2020_APSIPA.pdf" class="btn btn-sm z-depth-0 mr-0" role="button" target="_blank">pdf</a>
      
      
      
      
      
        <a href="https://github.com/beteje/Orientation" class="btn btn-sm z-depth-0 mr-0" role="button" target="_blank" rel="noopener">code</a>
      
    </div>

    <!-- Hidden abstract block -->
    
    <div class="abstract hidden">
      <p>Alignment and orientation of cells play an important part in the function of biological tissue. Recent developments in bioengineering using 3D scaffolds have created an increased need for computational techniques to measure orientation which extend beyond 2D measures to produce 3D measures of orientation. Initial studies of 3D alignment have focused on determining individual orientations, however, to truly understand the impact these structures have on the cellular alignment we need to understand the overall distribution of the orientations and their statistics. Hence, in this paper we develop an approach for determining 3D cellular alignment based on image gradients and directional statistics. The intensity gradients of the volumetric image are used to construct a 3D vector field and the local dominant orientations of this vector field then determined.</p>
    </div>
    
  </div>
</div>
</li></ol>
</div>


    
  </article>

</div>

    </div>

    <!-- Footer -->

    
<footer class="fixed-bottom">
  <div class="container mt-0">
    &copy; Copyright 2022 Beth  Jelfs.
    Powered by <a href="http://jekyllrb.com/" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener">GitHub Pages</a>.

    
    
  </div>
</footer>



  </body>

  <!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>

  <!-- Bootsrap & MDB scripts -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Masonry & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/masonry.js" type="text/javascript"></script>


  <!-- Load Common JS -->
<script src="/assets/js/common.js"></script>

  
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


</html>
